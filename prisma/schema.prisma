// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider   = "prisma-client-js"
  engineType = "client"
}

datasource db {
  provider = "postgresql"
}

model Etf {
  ticker         String          @id
  name           String
  currency       String
  exchange       String?
  price          Float
  daily_change   Float
  yield          Float?
  mer            Float?
  assetType      String          @default("ETF")
  isDeepAnalysisLoaded Boolean   @default(false)
  history        EtfHistory[]
  sectors        EtfSector[]
  allocation     EtfAllocation?
  portfolioItem  PortfolioItem?

  updatedAt      DateTime        @updatedAt
}

model EtfHistory {
  id        Int      @id @default(autoincrement())
  etfId     String
  date      DateTime
  close     Float
  interval  String   @default("daily")
  etf       Etf      @relation(fields: [etfId], references: [ticker])

  @@unique([etfId, date, interval])
}

model EtfSector {
  id          Int    @id @default(autoincrement())
  etfId       String
  sector_name String
  weight      Float
  etf         Etf    @relation(fields: [etfId], references: [ticker])
}

model EtfAllocation {
  id           Int    @id @default(autoincrement())
  etfId        String @unique
  stocks_weight Float
  bonds_weight  Float
  cash_weight   Float
  etf          Etf    @relation(fields: [etfId], references: [ticker])
}

model PortfolioItem {
  id        Int    @id @default(autoincrement())
  etfId     String @unique
  weight    Float
  shares    Float  @default(0)
  etf       Etf    @relation(fields: [etfId], references: [ticker])
}
